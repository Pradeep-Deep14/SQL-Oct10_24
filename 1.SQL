--DELETING DUPLICATE DATA FROM SALES TABLE


--IDENTIFYING DUPLICATES

WITH DUPLICATESALES AS
(SELECT STOREID,
        SALEDATE,
        AMOUNT,
        ROW_NUMBER()OVER(PARTITION BY STOREID,SALEDATE,AMOUNT ORDER BY SALEID)AS RN 
FROM SALES)


--DELETING DUPLICATES

DELETE FROM SALES
WHERE SALEID IN 
(SELECT SALEID FROM DUPLICATESALES WHERE RN > 1)